<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'profile.css' %}">
</head>

<body>
    <!-- NAVBAR -->
    <div class="navbar">
        <div class="logo">
            <a href="/" style="text-decoration: none; color: inherit; display: inline-block;">
                <h1 style="margin: 0;">SmartBid <span>ðŸ’¡</span></h1>
            </a>
        </div>

        <!-- DROPDOWN FOR USER OPTIONS -->
        <div class="dropdown">
            <a class="login-btn">You
                <i class="arrow down"></i></a>
            <div class="dropdown-content">
                <a href="{% url 'dashboard' %}">Dashboard</a>
                <a href="{% url 'adminPage' %}">Admin</a>
                <a href="{% url 'profile' %}">Profile</a>
                <a href="{% url 'logout' %}">Sign Out</a>
                <a href="profile.html">Profile Popup</a>
            </div>
        </div>
    </div>

    <!-- PROFILE POPUP -->
    <div id="profile-popup" class="profile-popup">
        <div class="profile-popup-content">
            <span class="close">&times;</span>
            <h1>My Profile</h1>

            <!-- templates/profile.html -->
            <h1>Welcome User {{ user.username }}!</h1>

            <div class="profile-popup-info">
                <div class="align-profile">
                    <p>{{ user.first_name }} {{ user.last_name }}</p>
                    <p>{{ average_rating }} ({{ rating_count }} Ratings)</p>
                </div>
            <p>Email: {{ user.email }}</p>
            <p>First Name: {{ user.first_name }}</p>
            <p>Last Name: {{ user.last_name }}</p>
            <p>ID #: {{ user.id }}</p>
            
            <!-- Add more profile information as needed -->

                <p><strong>Date Joined:</strong> {{ user.date_joined }}</p>
                <p><strong>Total Transactions:</strong> {{ total_transactions|default:0 }}</p>
            </div>
        </div>
    </div>

    <!-- PROFILE PAGE -->
    <div id="profile" class="profile">
        <div class="profile-content">
            <h1>My Profile</h1>

            <!-- templates/profile.html -->
            <h1>{{ user.username }}!</h1>
            <div class="align-profile">
                <p>{{ user.first_name }} {{ user.last_name }}</p>
                <p>{{ average_rating }} ({{ rating_count }} Ratings)</p>
            </div>
            <p>Email: {{ user.email }}</p>
            <p>First Name: {{ user.first_name }}</p>
            <p>Last Name: {{ user.last_name }}</p>
            <p>ID #: {{ user.id }}</p>
            <!-- Add more profile information as needed -->

            <div class="profile-info">
                <p><strong>Date Joined:</strong> {{ user.date_joined }}</p>
                <p><strong>Total Transactions:</strong> {{ total_transactions|default:0 }}</p>
            </div>
        </div>
    </div>
    <script>
        // OPEN PROFILE
        document.addEventListener("DOMContentLoaded", function() {
            const profilePopup = document.getElementById('profile-popup');
            const closePopupBtn = document.querySelector('.close');
            const profileLink = document.querySelector('.dropdown-content a[href="profile.html"]');

            profileLink.addEventListener('click', function(event) {
                event.preventDefault();
                profilePopup.style.display = 'block';
            });

            closePopupBtn.addEventListener('click', function() {
                profilePopup.style.display = 'none';
            });

            window.addEventListener('click', function(event) {
                if (event.target === profilePopup) {
                    profilePopup.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>